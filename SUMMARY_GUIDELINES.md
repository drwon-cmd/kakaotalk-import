# 카카오톡 대화 요약 지침

## 개요
이 문서는 카카오톡 단체 채팅방 대화 내용을 요약할 때 따라야 할 표준 지침입니다.
**다른 기기에서 나눈 대화도 분석 대상에 포함됩니다.**

## 폴더 구조
```
kakaotalk-import/
├── raw/                          # 원본 카카오톡 txt 파일
│   └── YYYY-MM-DD-NNN/           # 날짜-일렬번호 폴더
│       ├── 기기1_대화.txt
│       └── 기기2_대화.txt        # 다른 기기 대화도 같은 폴더에
├── summaries/                    # 요약된 미팅 메모 md 파일
│   └── YYYY-MM-DD-NNN/           # raw와 동일한 날짜-일렬번호
│       └── [채팅방명]_요약.md
└── SUMMARY_GUIDELINES.md         # 본 지침 파일
```

### 폴더 명명 규칙
- **형식**: `YYYY-MM-DD-NNN`
- **예시**: `2026-01-18-001`, `2026-01-18-002`
- **NNN**: 같은 날짜에 여러 번 분석 시 001, 002, 003... 순차 증가

## 분석 대상

### 폴더 선택 규칙
분석 명령 시 특정 폴더를 지정하지 않으면 다음 규칙을 따릅니다:

1. **자동 선택**: `summaries/` 폴더에 요약 파일이 없는 가장 최근 `raw/` 하위 폴더
2. **수동 지정**: "2026-01-17-001 카톡 요약해줘" 처럼 폴더명을 명시하면 해당 폴더 분석

**예시:**
```
raw/
├── 2026-01-15-001/  → summaries/2026-01-15-001/에 요약 있음 (스킵)
├── 2026-01-17-001/  → summaries/2026-01-17-001/에 요약 없음 ← 분석 대상
└── 2026-01-18-001/  → 아직 분석 안 함 (다음 차례)
```

### 포함되는 파일
1. **단체 채팅방 대화**: 카카오톡 내보내기 txt 파일
2. **다른 기기 대화**: 동일 채팅방의 다른 기기에서 내보낸 txt 파일
3. **여러 txt 파일**: 같은 날짜-일렬번호 폴더 내 모든 txt 파일 통합 분석

### 다중 파일 처리
- 같은 폴더 내 여러 txt 파일이 있을 경우 **모두 통합하여 분석**
- 중복 메시지는 자동으로 제거
- 시간순으로 정렬하여 하나의 요약 문서 생성

## 요약 규칙

### 1. 기간 설정
- 특정 기간이 지정되지 않은 경우: **최근 1개월 이내** 내용만 요약
- 가장 최근 대화부터 **역순**으로 정리

### 2. 문서 형식
미팅 메모 형식을 따름:

```markdown
# [채팅방명] 대화 요약

## 기본 정보
- **채팅방**: [채팅방 이름]
- **요약 기간**: YYYY.MM.DD ~ YYYY.MM.DD
- **참여자**: [참여자 목록]
- **요약 작성일**: YYYY.MM.DD
- **분석 파일**: [분석에 사용된 txt 파일 목록]

---

## 주요 논의 사항

### 1. [주제 1]
- 세부 내용 1
- 세부 내용 2
  - 하위 항목 a
  - 하위 항목 b

### 2. [주제 2]
1. 순서가 있는 항목 1
2. 순서가 있는 항목 2
3. 순서가 있는 항목 3

---

## 결정 사항
- [ ] 액션 아이템 1 (담당: @이름)
- [ ] 액션 아이템 2 (담당: @이름)
- [x] 완료된 항목

---

## 다음 단계 / 후속 조치
- 예정된 미팅 또는 일정
- 확인 필요 사항

---

## 기타 메모
- 참고 사항
- 공유된 링크 또는 파일
```

### 3. 정리 원칙
1. **주제별 분류**: 대화 내용을 맥락에 따라 주제별로 그룹화
2. **계층 구조**: 일렬번호(1, 2, 3)와 글머리기호(-, •)를 혼용하여 가독성 확보
3. **핵심 추출**: 잡담, 인사, 이모티콘 등 비핵심 내용은 제외
4. **시간순 역배열**: 가장 최근 내용을 상단에 배치
5. **액션 아이템 식별**: 결정 사항, 할 일, 약속 등을 명확히 구분

### 4. 상세도 기준 (중요)
요약은 **충분히 자세하게** 작성하여, 원본 대화를 읽지 않아도 맥락을 완전히 파악할 수 있어야 함.

#### 필수 포함 사항
1. **날짜별 구분**: 각 주제 내에서 날짜별로 논의 흐름을 시간 역순 (최신 우선) 정리
2. **발언자 명시**: 중요한 의견/제안/결정에는 발언자 이름 포함
3. **구체적 수치/정보**: 금액, 날짜, 수량, 회사명, 인명 등 구체적 정보 누락 금지
4. **맥락 설명**: 단순 나열이 아닌, 왜 그 논의가 나왔는지 배경 포함
5. **인용**: 핵심 발언은 직접 인용 또는 의역하여 포함
6. **공유 자료 상세**: 공유된 링크, 파일, 이미지의 내용 요약 포함

#### 상세도 예시
**나쁜 예 (너무 간략):**
```
### Manus AI 인수
- Meta가 Manus 인수
- 20-30억 달러 규모
```

**좋은 예 (충분히 상세):**
```
### Manus AI - Meta 인수 분석 (1/15)

#### 배경
Park Hee Duk이 Manus AI에 대한 상세 분석 자료를 공유하며 논의 시작.

#### Manus 회사 개요
- **정체성**: 싱가포르 기반(중국계 창업진) 범용 AI 에이전트 스타트업
- **제품 특징**: 단순 Q&A가 아닌 "목표 → 계획 → 실행 → 결과 생산"까지 자율 수행
  - 예: 비즈니스 분석 리포트 요청 시 웹 자료 수집 → 분석 → 최종 파일 생성까지 자동 완료
- **기술적 차별점**:
  - 멀티태스크 병렬 처리
  - 클라우드 네이티브 비동기 실행 (사용자 디바이스 독립)
  - 다양한 도메인 지원 (리서치, 코딩, 문서, 데이터 분석)
- **실적**: ARR 1억 달러 이상 (보도 기준)

#### 인수 딜 상세
- **발표 시점**: 2025년 12월 29-30일
- **딜 규모**: 20~30억 달러 (비공개, 복수 보도 추정치)
- **Meta의 의도**: "대화형 AI → 행동하는 AI(자동 실행형 에이전트)" 레벨업

#### 지정학적 리스크
- 2026년 1월 초, 중국 당국이 기술/데이터/수출통제 규정 위반 가능성 조사 착수
- Park Hee Duk 코멘트: "AI는 시장 점유가 아니라 인재·기술 이동 자체가 전장"

#### 투자/산업 시사점
1. Agentic AI의 빅테크 흡수 본격화
2. 지정학+법적 구조가 밸류에 직결
3. Meta 제품군(페북/인스타/왓츠앱/Meta AI) 통합 예정
```

#### 분량 가이드
- 1개월 분량 대화: 최소 **2,000자 이상**
- 각 주요 주제: 최소 **300자 이상**
- 중요 이벤트/결정: **500자 이상** 상세 기술

### 5. 파일 명명 규칙
```
[채팅방명]_[연도][월]_대화요약.md
[채팅방명]_[연도][월]_대화요약.pdf
예: 마케팅팀_2026년1월_대화요약.md / .pdf
```

### 6. 저장 위치
- **원본 txt 파일**: `kakaotalk-import/raw/YYYY-MM-DD-NNN/`
- **요약 md 파일**: `kakaotalk-import/summaries/YYYY-MM-DD-NNN/`
- **요약 pdf 파일**: `kakaotalk-import/summaries/YYYY-MM-DD-NNN/` (md와 동일 위치)
- raw와 summaries의 하위 폴더명(날짜-일렬번호)은 **동일하게 유지**

### 7. PDF 자동 생성
요약 md 파일 생성 후 **PDF 파일도 함께 생성**합니다.
- **변환 도구**: md-to-pdf (Node.js)
- **스크립트**: scripts/convert-to-pdf.ps1
- **실행**: Claude가 md 작성 후 자동 실행

## 특수 상황 처리

### 긴 대화의 경우
- 대화가 매우 긴 경우 주간 단위로 섹션 분리 고려
- 중요도에 따라 상세도 조절

### 다국어 대화
- 원어 유지를 기본으로 하되, 필요시 번역 병기

### 민감 정보
- 개인정보(전화번호, 주소 등)는 마스킹 처리
- 금융 정보는 요약에서 제외

### 다른 기기 대화 통합
- 동일 채팅방의 여러 기기 내보내기 파일은 같은 날짜-일렬번호 폴더에 저장
- 분석 시 모든 파일을 통합하여 처리
- 요약 문서에 분석에 사용된 파일 목록 명시

---

*이 지침은 추가 지시가 없을 때 기본으로 적용됩니다.*

---

## 자동화 스크립트

### 스크립트 위치
```
kakaotalk-import/scripts/
├── watch-and-organize.ps1    # 파일 감시 및 자동 정리
├── create-folder.ps1         # 폴더 생성 (CLI용)
├── new-kakao-folder.bat      # 바탕화면 단축키용
├── start-watcher.bat         # 감시 시작
├── install-autostart.ps1     # 시작 프로그램 등록
├── create-desktop-shortcut.ps1  # 바탕화면 단축키 생성
└── convert-to-pdf.ps1        # MD → PDF 변환
```

### 설치 방법

**1. 바탕화면 단축키 생성:**
```powershell
powershell -ExecutionPolicy Bypass -File "C:\wvb-ai-workspace\kakaotalk-import\scripts\create-desktop-shortcut.ps1"
```

**2. Windows 시작 시 자동 실행 등록:**
```powershell
powershell -ExecutionPolicy Bypass -File "C:\wvb-ai-workspace\kakaotalk-import\scripts\install-autostart.ps1"
```

### 사용 흐름

1. **자동 모드** (감시 스크립트 실행 중):
   - PC 카톡에서 대화 내보내기 → `raw/` 폴더에 저장
   - 자동으로 `raw/YYYY-MM-DD-NNN/` 폴더 생성 및 이동
   - 동시에 `summaries/YYYY-MM-DD-NNN/` 폴더도 생성

2. **수동 모드** (바탕화면 단축키):
   - "카톡 폴더 생성" 단축키 더블클릭
   - 오늘 날짜 폴더 생성 + 탐색기 자동 열림
   - PC 카톡에서 해당 폴더에 직접 저장

---

## 트러블슈팅

### PDCA Hook 파일 쓰기 오류

#### 증상
```
Error: File path kakaotalk-import/summaries/... does not match any allowed patterns
```

#### 원인
Claude Code의 PDCA hook이 허용되지 않은 경로에 파일 쓰기를 차단.

#### 해결 방법
`.claude/settings.json`의 PreToolUse hook 규칙에 kakaotalk-import 경로가 포함되어 있어야 함:

```json
{
  "matcher": "Write|Edit",
  "hooks": [{
    "prompt": "Check file path and apply PDCA rules:\n- kakaotalk-import/summaries/* → ALLOW (KakaoTalk summaries)\n- kakaotalk-import/*.md → ALLOW (KakaoTalk guidelines)\n..."
  }]
}
```

**현재 허용 경로:**
- `kakaotalk-import/summaries/*` - 요약 파일
- `kakaotalk-import/*.md` - 가이드라인 파일

### 한글 인코딩 오류

#### 증상
- PowerShell에서 한글이 깨져서 출력
- 파일명에 한글이 `????` 또는 깨진 문자로 표시

#### 원인
Bash → PowerShell 파이프 시 UTF-8 인코딩 손실

#### 해결 방법
1. **Write 도구 우선 사용** (권장)
   - Claude Code의 Write 도구는 UTF-8 인코딩을 올바르게 처리

2. **PowerShell 직접 호출 시**
   ```powershell
   [Console]::OutputEncoding = [System.Text.Encoding]::UTF8
   $PSDefaultParameterValues['Out-File:Encoding'] = 'utf8'
   ```

3. **Bash heredoc 사용 시 주의**
   - 한글 내 따옴표, 특수문자로 인한 구문 오류 발생 가능
   - 복잡한 한글 콘텐츠는 Write 도구 사용 권장

### 세션 재시작 후 정상 작동

#### 증상
이전 세션에서 실패했던 파일 쓰기가 새 세션에서 성공

#### 원인
- Hook 상태 캐시 초기화
- 권한 상태 갱신

#### 대응
- 반복 실패 시 세션 재시작 시도
- 근본 원인은 위의 PDCA hook 설정 확인
